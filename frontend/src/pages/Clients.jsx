import React,{useEffect,useState} from 'react'; import axios from 'axios'; export default function Clients({token,onLogout}){ const [list,setList]=useState([]); const [form,setForm]=useState({cpfcnpj:'',name:'',email:'',phone:''}); useEffect(()=>{ if(token) fetchClients(); },[token]); async function fetchClients(){ try{ const res = await axios.get('http://localhost:5000/clients',{headers:{Authorization:'Bearer '+token}}); setList(res.data);}catch(e){alert('Erro ao buscar clientes')} } async function createClient(e){ e.preventDefault(); try{ await axios.post('http://localhost:5000/clients', { CPFCNPJ: form.cpfcnpj, Name: form.name, Email: form.email, Phone: form.phone }, {headers:{Authorization:'Bearer '+token}}); setForm({cpfcnpj:'',name:'',email:'',phone:''}); fetchClients(); }catch(e){alert('Erro ao criar cliente')} } return (<div><div style={{display:'flex',justifyContent:'space-between'}}><h2>Clientes</h2><button onClick={onLogout}>Sair</button></div><form onSubmit={createClient}><input placeholder='CPF/CNPJ' value={form.cpfcnpj} onChange={e=>setForm({...form,cpfcnpj:e.target.value})}/><input placeholder='Nome' value={form.name} onChange={e=>setForm({...form,name:e.target.value})}/><input placeholder='Email' value={form.email} onChange={e=>setForm({...form,email:e.target.value})}/><input placeholder='Telefone' value={form.phone} onChange={e=>setForm({...form,phone:e.target.value})}/><button>Adicionar</button></form><table><thead><tr><th>CPF</th><th>Nome</th><th>Email</th><th>Telefone</th></tr></thead><tbody>{list.map(c=> <tr key={c.cpfcnpj}><td>{c.cpfcnpj}</td><td>{c.name}</td><td>{c.email}</td><td>{c.phone}</td></tr>)}</tbody></table></div>)}
